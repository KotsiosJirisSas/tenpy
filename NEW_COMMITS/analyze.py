import h5py
import matplotlib.pyplot as plt
import os
import numpy as np
from scipy.optimize import curve_fit
import plot_single_density
def linear_model(x, m, c):
    return m * x + c



def load_data(name):
    file_path='/mnt/users/dperkovic/quantum_hall_dmrg/segment_data/one_third_latest_laughlin_long/'
    #file_path = "/mnt/users/dperkovic/quantum_hall_dmrg/segment_data/one_third_latest_laughlin_deeper/"
    file_path='/mnt/users/dperkovic/quantum_hall_dmrg/segment_data/one_third_coloumb_xi=1/'
    #file_path='/mnt/users/dperkovic/quantum_hall_dmrg/segment_data/finite_dmrg_data/'
    file_path='/mnt/users/dperkovic/quantum_hall_dmrg/segment_data/single_layer_laughlin_2_3/'
    #file_path='/mnt/users/dperkovic/quantum_hall_dmrg/segment_data/one_third_coloumb_xi=1/'
    #file_path= '/mnt/users/dperkovic/quantum_hall_dmrg/segment_data/multilayer_2_3_boundary/'
    # Open the HDF5 file in read mode

    
    with h5py.File(file_path+name+'.h5', 'r') as h5_file:
        # List all datasets and groups in the file
        #print("Keys in the file:", list(h5_file.keys()))

        # Access a dataset or group
        data={}
       
        keys=['density','energy']#,'entanglement_spectrum']
        for dataset_name in keys:
            #print(dataset_name)
            #print(h5_file['entanglement_spectrum'])
            #print(list(h5_file['entanglement_spectrum']))
            #a=list(h5_file['energy'])
            #print(a)
            #quit()
            if dataset_name=='density':# or dataset_name=='entanglement_spectrum':
                print(dataset_name)
                data[dataset_name]= h5_file[dataset_name][:]
            if dataset_name=='energy':
                data[dataset_name]= h5_file[dataset_name][...]
            if dataset_name=='entanglement_spectrum':
                keys_of_dict = list(h5_file[dataset_name])
                #print(keys_of_dict)
                #print(list(h5_file[dataset_name]['6']))
                #quit()
                dikt={}
                for k in keys_of_dict:
                    #print(kaka)
                    dikt[k]=list(h5_file[dataset_name][k])
                    print(dikt)
                    quit()
                data[dataset_name]=dikt
                
        #print(len(data['entanglement_spectrum'][0]))
        #quit()
       
    return data;
def save_graph_data(name,dipoles,energies,Ks):
    with open(name+".txt", "w") as f:
        f.write("dipole:\n")
        f.write(str(dipoles)+"\n")
        f.write("Energies:\n")
        f.write(str(energies)+"\n")
        f.write("Ks:\n")
        f.write(str(Ks)+"\n")
def plot_densities():
    path = "/mnt/users/dperkovic/quantum_hall_dmrg/segment_data/one_third_latest_laughlin_long/"
    #path='/mnt/users/dperkovic/quantum_hall_dmrg/segment_data/finite_dmrg_data/'
    path='/mnt/users/dperkovic/quantum_hall_dmrg/segment_data/one_third_coloumb_xi=1/'
    path='/mnt/users/dperkovic/quantum_hall_dmrg/segment_data/multilayer_2_3_boundary/'
    #
    path='/mnt/users/dperkovic/quantum_hall_dmrg/segment_data/single_layer_laughlin_2_3/'
    dir_list = os.listdir(path)
    dir_list.sort()



    dipoles=[]
    mus=[]
    energies=[]
    for name in dir_list:
        val=''
        print(name)
        if  "infinite_well_L=113_nu=2_3_single_layer" in name and 'num=30' not in name:# and 'L=200' in name and "num=90" not in name and "num=99" not in name:# and 'num=0' in name:# and "['empty', 'empty', 'empty', 'empty', 'empty', 'full']" in name:# and 'L=200_xi=1_Coulumb_linear_' in name:# and 'num=0' in name: #and REDO# not in name:
          
            name=name[:-3] 
            
           
            #quit()
            data=load_data(name)
            
            
            try:
                ind=name.index('num')+4
                #print(name[ind:])
                #print(int(name[ind:]))
                mu=-int(name[ind:])//3#*2*np.pi/18
                if "['empty', 'full'," in name:
                    mu=int(name[ind:])//3

                
                #quit()
            except:
                mu=0
           
            if mu>-100:
                print("*"*30)
                print(name)
                print('mu:',mu)
                density=data['density']
                #EEs=data['entanglement_spectrum']
                print(data['energy'])
               
                print(np.sum(density))
               
                print(len(density[1::2])*2/3)
               
                dist=np.arange(len(density))//2
                ind=np.where(dist<200)
                
                ind2=np.where(dist>70)

                if 3*mu==0:
                 
                    print('charge of excitation:', np.sum(density[ind2]-1/3))
                    
                dipole=np.sum((density[ind]-1/3)*dist[ind])*8*np.pi**2/18**2
             
                print('NUMBER:')
                print(np.sum(density[ind]-1/3))
                indi=2

               
                print(dipole)
           
                density_2=np.zeros(len(density))
                for i in range(len(density)):
                    if i%6==2 or i%6==3:
                        density_2[i]=1
               
                energies.append(data['energy'])
                dipoles.append(dipole)
                
                
                mus.append(mu)
                
                plot_single_density.plot_density(density,name,mu)
                

    plt.figure()
    mus=np.array(mus)#/2
    #plt.scatter(mus,dipoles)
    print('AAAAAAAAA')
    name='figures/segment_L=164_energy_one_third_V=0.3'+val
    name='figures/segment_deeper_well_energy_one_third_V=0.3'
    #save_graph_data(name,dipoles,energies,list(mus))
    params, params_covariance = curve_fit(linear_model, mus, dipoles)
    print(params)
    params=np.array(params)#*18/(2*np.pi)
    xvals=np.linspace(0, np.max(mus),10)
    ys=linear_model(xvals,params[0],params[1])
    #print(params)
   
   
    a=np.argsort(mus)
    Ks=mus[a]
    ps=np.array(dipoles)[a]
    Es=np.array(energies)[a]
    plot_single_density.plot_energy(Ks,Es,ps,name)
   

#plot_densities()
#quit()
#PF-APF
a="[0.9999977 0.9999881 0.9999588 0.999641  0.9918514 0.9559058 0.8379944 0.1431266 0.043364  0.0177626 0.0114977 0.0167096 0.0398514 0.1076692 0.2580845 0.4914996 0.6944109 0.7644977 0.7442468 0.6929033 0.6203787 0.5192565 0.3908654 0.2791033 0.1993189 0.1682092 0.1887758 0.2593176 0.3702936 0.4995146 0.6068252 0.6686908 0.6850743 0.6657695 0.6135977 0.5369911 0.4500255 0.3730256 0.3194291 0.2934336 0.2980625 0.3340307 0.3974761 0.4768869 0.5556491 0.6189742 0.6554601 0.6609446 0.635739  0.5853156 0.5193567 0.4516417 0.3958627 0.3640383 0.3624647 0.3902776 0.4404654 0.5026882 0.5629474 0.6087426 0.630996  0.6267694 0.5979535 0.5518934 0.4993592 0.4518695 0.4190948 0.4070772 0.4171537 0.4458101 0.4863297 0.5300727 0.5678435 0.5923639 0.5996338 0.5892496 0.5645265 0.5313202 0.4967068 0.467468  0.449319  0.4456526 0.4563162 0.4771808 0.5014822 0.5225044 0.5357613 0.5407078 0.5398474 0.5363457 0.5324356 0.5276475 0.5205139 0.5109967 0.5012457 0.494739  0.4925586 0.4950109 0.5008767 0.508312  0.5152258 0.5199783 0.5217196 0.5204514 0.5168349 0.5118359 0.5062597 0.500711  0.4959467 0.4927265 0.4913428 0.4915213 0.4928825 0.4953    0.4986399 0.5022582 0.5051381 0.5066259 0.5067807 0.5059628 0.5043592 0.5020496 0.4993575 0.4968731 0.4951729 0.4945833 0.4950835 0.4963965 0.49814   0.4999461 0.5015039 0.5025807 0.5030536 0.5029295 0.5023081 0.5013127 0.5000701 0.498775  0.4977105 0.4971359 0.4971679 0.4977736 0.4987886 0.4999488 0.5009621 0.5016191 0.5018482 0.5016919 0.5012456 0.5006128 0.4999035 0.4992382 0.4987322 0.4984788 0.4985292 0.4988701 0.4994219 0.5000619 0.5006547 0.5010731 0.5012279 0.5010967 0.500735  0.5002529 0.4997722 0.4993891 0.4991628 0.4991142 0.4992322 0.4994804 0.4998057 0.5001452 0.5004349 0.5006244 0.5006863 0.5006188 0.5004378 0.5001771 0.4998887 0.4996347 0.4994714 0.4994295 0.499507  0.4996741 0.4998831 0.5000902 0.5002608 0.5003785 0.5004313 0.5004157 0.5003325 0.5001964 0.5000307 0.4998555 0.4997016 0.4995952 0.4995572 0.4995903 0.4996997 0.4998622 0.5000639 0.5002659 0.5004367 0.500551  0.5005728 0.5004998 0.5003141 0.5000521 0.4997441 0.4994472 0.4992377 0.4991701 0.4992623 0.4995355 0.4999161 0.5003393 0.4956025 0.5308015"#PF-VACUUM OLD ENV

a="0.9999976 0.9999875 0.9999569 0.9996632 0.9919083 0.9559598 0.836803  0.1433611 0.043472  0.0182263 0.0122146 0.0183003 0.0441329 0.1193918 0.278571  0.5177087 0.7026596 0.7553519 0.7205136 0.6614038 0.5906512 0.5008082 0.3893754 0.2897473 0.2164649 0.1879984 0.2103337 0.2830323 0.3943142 0.5152653 0.6066963 0.6521916 0.655981  0.6277763 0.5710174 0.4917285 0.4060245 0.3368426 0.3012952 0.3065836 0.3496288 0.4181976 0.4969125 0.5701228 0.6254832 0.6556837 0.6557948 0.62387   0.5648147 0.491305  0.4214097 0.3717351 0.3521049 0.3652652 0.4072112 0.4691666 0.5374628 0.5968708 0.6338721 0.6412101 0.6188417 0.5735133 0.5160367 0.4578628 0.4111567 0.3842387 0.382057  0.4051344 0.4491477 0.5050627 0.5596953 0.6009606 0.6207944 0.6163052 0.5897237 0.5474969 0.4993988 0.4569124 0.4302748 0.4251346 0.4410269 0.4723343 0.5100301 0.5443606 0.5678914 0.5769318 0.571663  0.5547922 0.5304165 0.503699  0.4804212 0.4661786 0.4639811 0.4739062 0.4919227 0.5117056 0.5277068 0.5379208 0.5422688 0.5409645 0.5345843 0.5251906 0.5155172 0.5088533 0.5039199 0.4993656 0.4947978 0.4913574 0.4906482 0.4931667 0.4977176 0.5023213 0.5056043 0.5072552 0.507485  0.5064883 0.5045372 0.5022446 0.5004135 0.499421  0.4989197 0.4984131 0.4978313 0.4974251 0.4974196 0.4978858 0.4987315 0.4997347 0.5006385 0.5012285 0.5014183 0.5012777 0.5009696 0.5006447 0.5003606 0.500043  0.499568  0.4989331 0.4983257 0.4979997 0.4981107 0.4986679 0.4995362 0.5004589 0.5011532 0.5014421 0.5013284 0.5009464 0.5004524 0.499964  0.4995487 0.499231  0.4990042 0.4988741 0.4988834 0.49909   0.4995116 0.500093  0.5007046 0.5011707 0.5013325 0.5011272 0.5006263 0.5000062 0.4994536 0.4991015 0.4989979 0.499114  0.4993703 0.4996848 0.500002  0.5002947 0.5005393 0.5007063 0.5007604 0.5006723 0.5004297 0.5000644 0.4996624 0.4993435 0.4992026 0.4992745 0.4995253 0.4998699 0.5002045 0.500448  0.5005636 0.5005583 0.5004534 0.5002773 0.5000627 0.4998458 0.4996604 0.4995345 0.4995002 0.4995772 0.4997615 0.5000166 0.5002779 0.5004809 0.5005594 0.5004927 0.5002964 0.5000317 0.4997655 0.4995635 0.4994621 0.4994933 0.4996397 0.49987   0.5001304 0.5003616 0.5005254 0.5005776 0.5005188 0.500341  0.5014081 0.4852455"
#PF-VACUUM NEW ENV
#a="0.5156502 0.999613  0.9947513 0.9402879 0.8064776 0.2035716 0.0685899 0.0609239 0.0861728 0.0928465 0.1220209 0.2203825 0.3973207 0.615049  0.7727173 0.9014587 0.9349436 0.8541717 0.6544928 0.3525371 0.1512212 0.0769241 0.0802133 0.1385865 0.2466498 0.390215  0.5698585 0.7364021 0.8503991 0.8913588 0.8608618 0.7652305 0.5968159 0.3903407 0.2357887 0.1562356 0.1409945 0.182559  0.2758441 0.4127791 0.5663284 0.6800324 0.7407581 0.7529135 0.7235048 0.6631803 0.5857023 0.5055223 0.4334471 0.3761915 0.3420197 0.3370038 0.3647459 0.4211208 0.4947667 0.5692246 0.6288383 0.6624007 0.6644411 0.6353787 0.5820972 0.5170027 0.4553864 0.4102486 0.3894126 0.3945118 0.4212485 0.4618143 0.5071515 0.5486737 0.57944   0.5943623 0.5908521 0.5698523 0.5362615 0.4978043 0.4626556 0.4373344 0.4256123 0.4286986 0.4455009 0.4725672 0.5042529 0.5336572 0.5545101 0.5627439 0.557384  0.540509  0.5164535 0.4906268 0.4683303 0.4538516 0.4497009 0.4561029 0.4709569 0.4904987 0.5104225 0.5268256 0.5368441 0.5389031 0.5328951 0.5202772 0.5039966 0.487887  0.4755474 0.4693363 0.4698899 0.4763115 0.4867631 0.4989952 0.5106581 0.519518  0.5238757 0.5230035 0.5173928 0.5086112 0.4987689 0.4899215 0.483673  0.4810162 0.482275  0.4870506 0.4942019 0.5020187 0.5087167 0.5129712 0.514212  0.5125834 0.5087227 0.5035525 0.4981258 0.4934759 0.4904487 0.489526  0.490694  0.4934385 0.4969946 0.5006451 0.5038517 0.5061705 0.507248  0.5069401 0.5054242 0.503134  0.5006378 0.4984308 0.4968023 0.4957513 0.4951802 0.4950633 0.4955016 0.496515  0.4980299 0.4999414 0.5021794 0.5044898 0.5064388 0.5074721 0.5071776 0.5053627 0.5022857 0.4985408 0.494921  0.4920554 0.4903681 0.4900823 0.491421  0.4944034 0.4989272 0.5045932 0.5106398 0.5156763 0.5180943 0.5164958 0.5104345 0.5008008 0.4898511 0.4803331 0.4747511 0.4745718 0.4799373 0.4897839 0.5020171 0.5142328 0.524427  0.5311875 0.533461  0.5300522 0.519572  0.5015674 0.4779067 0.4547068 0.4409896 0.4435999 0.4635511 0.4922683 0.5216637 0.5430816 0.5488724 0.5457759 0.5364585 0.5237497 0.5125697 0.505602  0.4995657 0.4857532 0.4568723 0.4161591 0.3856878 0.3940264 0.4535189 0.5481904 0.6523378 0.7307874 0.7416805 0.6240022 0.3768668 0.1135583"
a="0.4190535 0.4539815 0.5196249 0.5667756 0.579392  0.5653673 0.5283868 0.4858895 0.4631822 0.4604257 0.4687902 0.4789947 0.4872379 0.4933673 0.4982351 0.5027192 0.507396  0.5118925 0.5148284 0.5146005 0.5105028 0.5033815 0.4954831 0.4893612 0.4867715 0.488027  0.4920566 0.4971143 0.5015972 0.5045823 0.5059126 0.5059094 0.5050243 0.5035976 0.5018098 0.4998259 0.4978988 0.4963632 0.4955598 0.4957037 0.4968019 0.4986089 0.5006537 0.5023814 0.5033427 0.5033503 0.5025365 0.5012593 0.4999396 0.4988974 0.4982786 0.4980871 0.4982552 0.4986856 0.4992767 0.499926  0.5005367 0.5010166 0.5012846 0.5012858 0.5010136 0.5005215 0.4999291 0.499393  0.4990577 0.498993  0.499174  0.4995074 0.4998833 0.5002105 0.5004377 0.5005477 0.5005479 0.5004538 0.5002885 0.5000835 0.4998794 0.4997124 0.4996112 0.4995931 0.4996638 0.4998056 0.4999808 0.5001419 0.5002516 0.5002881 0.5002542 0.5001703 0.5000674 0.4999694 0.4998915 0.4998421 0.4998282 0.4998482 0.4998943 0.4999544 0.5000185 0.5000738 0.5001099 0.5001196 0.5001045 0.5000681 0.5000189 0.4999688 0.4999327 0.4999171 0.4999214 0.4999398 0.4999681 0.4999986 0.5000249 0.500042  0.5000501 0.5000481 0.5000367 0.5000179 0.4999984 0.4999817 0.4999696 0.4999632 0.499966  0.4999765 0.4999909 0.5000044 0.5000161 0.5000232 0.500024  0.5000186 0.5000113 0.5000034 0.4999955 0.499988  0.4999846 0.4999851 0.4999883 0.4999921 0.499998  0.5000043 0.5000088 0.5000098 0.5000097 0.5000081 0.5000045 0.499999  0.4999955 0.4999939 0.4999936 0.4999932 0.4999952 0.4999984 0.5000013 0.5000023 0.5000038 0.5000048 0.5000045 0.5000021 0.5000005 0.4999995 0.4999984 0.4999965 0.4999965 0.4999978 0.4999991 0.4999993 0.5000005 0.500002  0.5000027 0.5000014 0.5000011 0.5000011 0.5000007 0.4999988 0.4999984 0.499999  0.4999994 0.4999986 0.4999992 0.5000005 0.5000013 0.5000004 0.5000006 0.5000012 0.5000012 0.4999997 0.4999995 0.5       0.5000001 0.499999  0.4999992 0.5000001 0.5000006 0.4999997 0.5       0.5000008 0.5000011 0.4999999 0.4999998 0.5000004 0.5000006 0.4999993 0.4999995 0.5000002"
a="0.3151681 0.9996224 0.9945541 0.9468583 0.8150669 0.1892271 0.0592345 0.0468667 0.0664485 0.0771008 0.1091041 0.210328  0.4216446 0.648848  0.7891875 0.914885  0.9442777 0.8582837 0.6617763 0.3322812 0.1382285 0.0711425 0.0753331 0.1293598 0.2362142 0.403871  0.5978438 0.7745336 0.8565218 0.8812285 0.8397618 0.7296702 0.5532776 0.3668811 0.2400515 0.1777628 0.1754486 0.2273934 0.329468  0.4666864 0.6043971 0.7053784 0.7566637 0.7587808 0.7118989 0.6229287 0.5114049 0.4085197 0.3386631 0.3107845 0.3234067 0.3742095 0.4558207 0.5499773 0.6279543 0.6703638 0.6710766 0.6363575 0.5808275 0.5194425 0.463014  0.4181531 0.3896945 0.3828508 0.4012129 0.4428097 0.4976714 0.5508945 0.5894297 0.6060465 0.6001459 0.5755317 0.5381587 0.4952729 0.4550768 0.4259463 0.4142618 0.4223306 0.4473113 0.4820571 0.5177784 0.5468407 0.5643421 0.5680512 0.5580191 0.5366423 0.5086828 0.48047   0.4581298 0.4460474 0.4459567 0.4569481 0.476065  0.499093  0.5211984 0.5376578 0.5449975 0.5420732 0.5303905 0.513362  0.4950317 0.4790905 0.4683502 0.4645676 0.4682182 0.4783247 0.4924648 0.5072669 0.5193895 0.5264797 0.5276275 0.5232192 0.5145226 0.5034061 0.492134  0.4830632 0.4780729 0.4780648 0.4827175 0.4906378 0.4998599 0.5084102 0.5146841 0.5176114 0.516759  0.5124552 0.5057879 0.4983642 0.4918357 0.4874902 0.4860163 0.4874789 0.4913931 0.4968529 0.5026674 0.5075724 0.5105303 0.5110252 0.5091753 0.5056184 0.5012353 0.4969338 0.4935141 0.4916016 0.4915282 0.4932451 0.4962937 0.4999146 0.5032694 0.5056786 0.5067551 0.5064173 0.5048239 0.5023402 0.4994973 0.4969174 0.4951499 0.4945306 0.4951032 0.4966467 0.4987626 0.5009879 0.5028805 0.504082  0.504369  0.5037166 0.502316  0.5005288 0.4987633 0.4973753 0.4966059 0.4965682 0.4972342 0.4984456 0.4999315 0.5013625 0.5024256 0.5029104 0.502757  0.5020534 0.5009738 0.4997452 0.4986105 0.4978033 0.497487  0.497723  0.4984411 0.4994657 0.5005591 0.5014876 0.5020717 0.5022201 0.5019082 0.5012032 0.5002504 0.4992593 0.498434  0.4979529 0.4979015 0.4982887 0.4990465 0.500056  0.5011413 0.5021054 0.5027409 0.5028712 0.5022355 0.5007584 0.4987865 0.4968529 0.4954889 0.4950772 0.4957678 0.4974644 0.4996538 0.5017456 0.5032696 0.5038699"

a="0.5000006 0.4999999 0.4999995 0.5000003 0.5       0.4999994 0.499999  0.5000001 0.5000002 0.5       0.4999999 0.5000011 0.5000011 0.5000006 0.5000001 0.5000008 0.5000003 0.4999994 0.4999987 0.4999996 0.4999995 0.4999993 0.4999994 0.5000011 0.5000016 0.5000016 0.5000015 0.5000024 0.5000017 0.5000003 0.499999  0.4999992 0.4999985 0.4999979 0.4999979 0.4999999 0.5000011 0.500002  0.5000029 0.5000047 0.5000047 0.5000035 0.5000018 0.5000009 0.4999986 0.4999961 0.4999946 0.4999959 0.4999974 0.4999996 0.5000027 0.500007  0.5000092 0.5000095 0.5000083 0.5000069 0.5000029 0.4999977 0.4999932 0.4999912 0.4999899 0.4999906 0.4999943 0.5000018 0.5000095 0.5000164 0.5000213 0.5000234 0.500019  0.5000097 0.4999985 0.4999888 0.4999802 0.4999755 0.4999767 0.4999851 0.4999968 0.5000109 0.5000259 0.5000397 0.5000466 0.5000453 0.5000353 0.5000172 0.4999905 0.4999624 0.4999419 0.4999369 0.4999476 0.4999735 0.50001   0.5000492 0.5000799 0.5000972 0.5000985 0.5000831 0.5000491 0.500003  0.4999535 0.4999092 0.4998755 0.4998641 0.4998864 0.4999467 0.5000353 0.5001349 0.5002192 0.5002604 0.5002385 0.5001582 0.5000416 0.499916  0.4998047 0.4997319 0.4997137 0.4997534 0.4998419 0.4999723 0.5001351 0.5003104 0.5004636 0.5005544 0.5005374 0.5003777 0.5000785 0.4997097 0.4993831 0.4992022 0.4992221 0.4994416 0.4998048 0.5002202 0.5005974 0.5008813 0.5010455 0.5010707 0.5009353 0.5006238 0.5001264 0.4994597 0.4987168 0.4981078 0.4978939 0.4982538 0.4991858 0.5004886 0.5018206 0.5028115 0.5032025 0.502929  0.5020991 0.5009127 0.4995745 0.4982471 0.4970193 0.4959487 0.4952091 0.4951994 0.4963835 0.4989432 0.5025832 0.506518  0.5097187 0.5112011 0.5102783 0.5068221 0.5014135 0.4952605 0.4897    0.4856578 0.4833295 0.4825442 0.4837765 0.4884758 0.4983314 0.513451  0.5310868 0.5463542 0.554227  0.5511207 0.534711  0.5053298 0.4687457 0.4350641 0.414193  0.4101833 0.4166402 0.4239182 0.4416699 0.5008094 0.6307442 0.7804808 0.877555  0.8844659 0.8068202 0.6731209 0.4235408 0.1753633 0.0550155 0.0029299"
a="0.4956986 0.4998014 0.5000887 0.5003749 0.5006008 0.5007147 0.5006846 0.5004946 0.5001723 0.4997821 0.4994142 0.4991521 0.4990598 0.4991645 0.499458  0.4998899 0.5003844 0.5008388 0.5011451 0.5012105 0.5010045 0.5005611 0.4999712 0.4993477 0.4988165 0.4984938 0.4984733 0.4987916 0.4994149 0.5002244 0.5010427 0.5016756 0.5019775 0.5018716 0.5013583 0.5005063 0.499465  0.4984468 0.4976945 0.4974069 0.497685  0.4984956 0.4996878 0.5010254 0.502243  0.5030737 0.5032954 0.5027858 0.5015964 0.4999563 0.4982236 0.4967785 0.4959396 0.4959067 0.496747  0.4983673 0.5005025 0.5027177 0.5044924 0.5053619 0.5050777 0.503661  0.5013749 0.4986391 0.495972  0.4939323 0.4930442 0.4936493 0.4957624 0.4990026 0.502678  0.5059716 0.5081577 0.5087234 0.5074376 0.5044012 0.5001119 0.4954294 0.4914191 0.4890611 0.4889708 0.4912596 0.4955619 0.5011146 0.5068631 0.5115679 0.5140319 0.5134467 0.5097284 0.5035875 0.4963182 0.4894256 0.4843108 0.4821068 0.4835403 0.4886963 0.496812  0.5062666 0.5149106 0.5206647 0.5221191 0.5188205 0.511272  0.5007913 0.4893501 0.4793245 0.4730769 0.47235   0.4777121 0.4883475 0.5022431 0.5166156 0.5284628 0.5350659 0.5344454 0.5259405 0.510801  0.4922616 0.4748974 0.4631814 0.4599444 0.4655891 0.4785196 0.4961031 0.5154064 0.5332984 0.5465741 0.5524034 0.5491118 0.5369082 0.5179404 0.4954515 0.4732076 0.4556331 0.4480692 0.4556879 0.4809543 0.5204579 0.5635453 0.5953611 0.6031    0.5832839 0.5434205 0.4976399 0.4612968 0.4429906 0.4421661 0.4531951 0.472049  0.4994067 0.5369213 0.5768345 0.6036961 0.6046598 0.5785764 0.5330519 0.4891043 0.463125  0.4645904 0.4666099 0.433775  0.4065845 0.4252721 0.4924828 0.5827429 0.6597703 0.6913807 0.6779511 0.6303925 0.6144811 0.5460165 0.4464751 0.4023084 0.4142456 0.4406299 0.4984716 0.5685116 0.6166634 0.5965115 0.5524445 0.5277479 0.5681094 0.4931567 0.4344641 0.4437249 0.2692416 0.1742536 0.190348  0.1489412 0.1067649 0.1376483 0.2947758 0.6502227 0.8022928 0.7264936 0.2656281 0.078891  0.0827939 0.9452317 0.9966667"
a="0.4999516 0.4999676 0.5000219 0.5001015 0.5001422 0.5000712 0.4998863 0.4996806 0.4995988 0.4997258 0.5000158 0.5003099 0.5004246 0.5002807 0.4999645 0.4996684 0.4995575 0.499659  0.4998653 0.5000386 0.5001085 0.5001071 0.5001106 0.5001528 0.5001661 0.5000493 0.4997813 0.4994929 0.4993949 0.4996154 0.5000798 0.5005364 0.5006936 0.5004306 0.499895  0.4994123 0.499263  0.499492  0.4999054 0.5002387 0.5003355 0.5002351 0.5000976 0.5000436 0.5000378 0.4999463 0.4997013 0.4994213 0.4993489 0.4996474 0.5002325 0.5007833 0.5009199 0.5004913 0.4997159 0.4990579 0.4989153 0.4993433 0.5000388 0.5005788 0.5006941 0.5004297 0.500059  0.4998369 0.4998005 0.4997918 0.4996637 0.4994694 0.4994375 0.4997569 0.5003658 0.5009291 0.5010229 0.5004765 0.4995506 0.4988014 0.4987067 0.4993236 0.500256  0.5009458 0.5010266 0.5005549 0.4999206 0.4995258 0.4994958 0.4996523 0.4997449 0.4997125 0.4997184 0.4999639 0.500452  0.5009065 0.5009317 0.5003518 0.4994223 0.4987063 0.4986935 0.4994329 0.5004842 0.5012236 0.5012352 0.5005876 0.499753  0.4992413 0.4992501 0.4995917 0.4999222 0.5000567 0.5000698 0.5001635 0.5004267 0.5006994 0.5006688 0.5001695 0.4993979 0.4988351 0.498907  0.49965   0.500649  0.5013111 0.5012399 0.5005111 0.4996117 0.499079  0.4991411 0.4996153 0.5001113 0.5003586 0.5003518 0.5002812 0.5003113 0.5004081 0.5003646 0.5000311 0.4995147 0.4991531 0.4992634 0.4998742 0.5006586 0.5011427 0.5010074 0.5003278 0.4995321 0.499095  0.4992227 0.4997476 0.5002934 0.5005679 0.500519  0.5003131 0.5001559 0.5001094 0.5000667 0.4999038 0.4996449 0.4994807 0.4996088 0.5000485 0.5005821 0.5008851 0.5007368 0.5001994 0.499594  0.4992777 0.4994058 0.4998467 0.5003    0.5005208 0.5004506 0.500221  0.5000244 0.4999555 0.4999658 0.4999518 0.4998783 0.4998222 0.4998886 0.500102  0.5003565 0.5004789 0.5003481 0.5000077 0.4996581 0.4995178 0.4996727 0.5000218 0.5003537 0.5004938 0.5003983 0.5001632 0.4999433 0.4998329 0.4998242 0.499852  0.4998724 0.4999043 0.4999905 0.5001405 0.5003002 0.5003737 0.5002926 0.5000811 0.4998521 0.4997323 0.4997752 0.4999301 0.5000847 0.5001474 0.5000995 0.4999979 0.4999296 0.4999437 0.5000293 0.5001291 0.5001892 0.5001871 0.5001395 0.5000751"
#a="5.3898755e-13 1.2887108e-11 1.4809760e-10 1.2970801e-09 7.9122374e-09 2.8666862e-08 8.5850184e-08 1.1394598e-01 2.8254026e-01 4.2227547e-01 4.9076518e-01 4.9841300e-01 4.7076222e-01 4.2867866e-01 3.8645843e-01 3.5236412e-01 3.2999987e-01 3.1967296e-01 3.1912299e-01 3.2420678e-01 3.2995916e-01 3.3184316e-01 3.2697711e-01 3.1512751e-01 2.9892222e-01 2.8298895e-01 2.7231804e-01 2.7091741e-01 2.8161337e-01 3.0617619e-01 3.4466166e-01 3.9398991e-01 4.4611132e-01 4.9431367e-01 4.9831934e-01 4.6641478e-01 4.0139621e-01 3.1808340e-01 2.3678710e-01 1.7324577e-01 1.2893004e-01 9.3210675e-02 8.8698967e-02 1.0962082e-01 1.8358320e-01 3.1932307e-01 4.6308822e-01 6.4249453e-01 7.3594621e-01 7.4981937e-01 6.8604298e-01 5.4720631e-01 3.2776663e-01 1.7795570e-01 1.0627897e-01 7.7737471e-02 6.4825208e-02 7.7700180e-02 1.4076862e-01 2.4827697e-01 3.6908090e-01 4.5761594e-01 4.9260771e-01 4.8267576e-01 4.4530942e-01 3.9801427e-01 3.5432612e-01 3.2145548e-01 3.0115700e-01 2.9210286e-01 2.9184381e-01 2.9775924e-01 3.0734549e-01 3.1829170e-01 3.2860583e-01 3.3681760e-01 3.4214232e-01 3.4449359e-01 3.4433309e-01 3.4243156e-01 3.3963086e-01 3.3666687e-01 3.3407267e-01 3.3215282e-01 3.3100671e-01 3.3057849e-01 3.3071547e-01 3.3122269e-01 3.3190669e-01 3.3260540e-01 3.3320396e-01 3.3363852e-01 3.3389082e-01 3.3397717e-01 3.3393525e-01 3.3381150e-01 3.3365093e-01 3.3349044e-01 3.3335540e-01 3.3325919e-01 3.3320484e-01 3.3318781e-01 3.3319905e-01 3.3322788e-01 3.3326421e-01 3.3329993e-01 3.3332960e-01 3.3335044e-01 3.3336197e-01 3.3336534e-01 3.3336262e-01 3.3335616e-01 3.3334817e-01 3.3334039e-01 3.3333399e-01 3.3332953e-01 3.3332709e-01 3.3332642e-01 3.3332705e-01 3.3332846e-01 3.3333019e-01 3.3333185e-01 3.3333322e-01 3.3333416e-01 3.3333467e-01 3.3333481e-01 3.3333467e-01 3.3333436e-01 3.3333400e-01 3.3333364e-01 3.3333335e-01 3.3333316e-01 3.3333305e-01 3.3333302e-01 3.3333305e-01 3.3333312e-01 3.3333319e-01 3.3333327e-01 3.3333333e-01 3.3333337e-01 3.3333340e-01 3.3333340e-01 3.3333340e-01 3.3333338e-01 3.3333336e-01 3.3333335e-01 3.3333333e-01 3.3333332e-01 3.3333331e-01 3.3333330e-01 3.3333330e-01 3.3333331e-01 3.3333332e-01 3.3333334e-01 3.3333336e-01 3.3333338e-01 3.3333340e-01 3.3333342e-01 3.3333342e-01 3.3333340e-01 3.3333337e-01 3.3333331e-01 3.3333323e-01 3.3333314e-01 3.3333306e-01 3.3333300e-01 3.3333300e-01 3.3333307e-01 3.3333322e-01 3.3333346e-01 3.3333378e-01 3.3333412e-01 3.3333443e-01 3.3333462e-01 3.3333459e-01 3.3333426e-01 3.3333359e-01 3.3333261e-01 3.3333145e-01 3.3333034e-01 3.3332961e-01 3.3332952e-01 3.3333025e-01 3.3333176e-01 3.3333379e-01 3.3333592e-01 3.3333767e-01 3.3333869e-01 3.3333904e-01 3.3333895e-01 3.3333876e-01 3.3333851e-01 3.3333806e-01 3.3333748e-01 3.3333626e-01 3.3333531e-01 3.3333408e-01 3.3333187e-01 3.3333020e-01 3.3331971e-01"

a="0.5000066 0.5000038 0.500003  0.4999985 0.4999931 0.4999887 0.4999893 0.4999897 0.4999885 0.4999873 0.499988  0.4999874 0.4999859 0.4999857 0.4999885 0.4999899 0.4999885 0.4999866 0.4999855 0.4999822 0.4999768 0.4999722 0.4999706 0.4999678 0.4999624 0.4999576 0.4999567 0.4999549 0.4999495 0.4999446 0.4999444 0.499944  0.4999388 0.4999339 0.499935  0.4999362 0.4999317 0.4999269 0.4999299 0.4999334 0.4999289 0.4999244 0.4999315 0.4999428 0.4999461 0.4999504 0.4999723 0.5000016 0.5000197 0.500037  0.5000769 0.5001307 0.5001708 0.5002085 0.5002773 0.5003707 0.5004511 0.5005257 0.5006408 0.5007967 0.5009419 0.5010741 0.5012495 0.501476  0.5016854 0.5018612 0.5020721 0.5023407 0.5025896 0.5027851 0.5030069 0.5032955 0.5035667 0.5037637 0.5039681 0.5042316 0.5044622 0.5045807 0.5046736 0.5048142 0.5049181 0.5048886 0.5048104 0.504779  0.5047254 0.5045348 0.5042826 0.504075  0.5038656 0.5035273 0.503116  0.5027431 0.5023829 0.501905  0.5013522 0.500848  0.5003978 0.499869  0.4992843 0.4987681 0.4983514 0.4979012 0.4974081 0.4969859 0.4966803 0.4963588 0.495991  0.4956908 0.4955265 0.4953758 0.4951842 0.4950557 0.4950711 0.4951226 0.4951324 0.4951821 0.4953551 0.4955623 0.4957143 0.4958751 0.4961279 0.4964021 0.4966108 0.4968055 0.497071  0.4973598 0.4975889 0.4977894 0.4980355 0.4982985 0.498503  0.4986631 0.4988433 0.4990357 0.4991814 0.4992862 0.4994039 0.4995373 0.4996389 0.4997027 0.4997682 0.4998439 0.4998963 0.4999173 0.4999375 0.49997   0.4999933 0.4999989 0.5000086 0.5000336 0.5000575 0.5000698 0.5000826 0.5001018 0.5001141 0.5001091 0.500096  0.5000831 0.5000654 0.5000396 0.500016  0.5000046 0.500004  0.5000114 0.500031  0.5000641 0.500099  0.5001225 0.5001311 0.5001251 0.500101  0.5000572 0.5000015 0.4999457 0.4998994 0.4998714 0.4998715 0.4999059 0.4999708 0.5000519 0.5001352 0.5002068 0.5002471 0.5002387 0.5001753 0.5000647 0.4999255 0.49979   0.4996961 0.4996697 0.4997204 0.4998261 0.4999577 0.5000856 0.5001881 0.5002583 0.500305  0.4978492"
a="3.3062011e-01 3.3097856e-01 3.3205838e-01 3.3272863e-01 3.3389191e-01 3.3445553e-01 3.3539089e-01 3.3586758e-01 3.3662869e-01 3.3675477e-01 3.3709548e-01 3.3697651e-01 3.3687520e-01 3.3651942e-01 3.3604288e-01 3.3547824e-01 3.3476162e-01 3.3407739e-01 3.3326463e-01 3.3269932e-01 3.3195140e-01 3.3172148e-01 3.3122752e-01 3.3131308e-01 3.3119479e-01 3.3148012e-01 3.3170914e-01 3.3206230e-01 3.3249031e-01 3.3281009e-01 3.3325835e-01 3.3349491e-01 3.3381334e-01 3.3394736e-01 3.3407635e-01 3.3409781e-01 3.3407505e-01 3.3402048e-01 3.3389522e-01 3.3379070e-01 3.3362786e-01 3.3350020e-01 3.3337296e-01 3.3325682e-01 3.3318799e-01 3.3310410e-01 3.3309211e-01 3.3304639e-01 3.3308070e-01 3.3308719e-01 3.3312952e-01 3.3317602e-01 3.3319081e-01 3.3326003e-01 3.3324976e-01 3.3333608e-01 3.3328876e-01 3.3336225e-01 3.3330066e-01 3.3333664e-01 3.3331076e-01 3.3330761e-01 3.3333495e-01 3.3327897e-01 3.3337518e-01 3.3326716e-01 3.3344338e-01 3.3331127e-01 3.3352130e-01 3.3338195e-01 3.3356682e-01 3.3345087e-01 3.3355993e-01 3.3350089e-01 3.3346116e-01 3.3347573e-01 3.3324536e-01 3.3335291e-01 3.3294596e-01 3.3316586e-01 3.3262691e-01 3.3294042e-01 3.3239279e-01 3.3273656e-01 3.3238130e-01 3.3265456e-01 3.3270074e-01 3.3276273e-01 3.3341067e-01 3.3307234e-01 3.3444888e-01 3.3354447e-01 3.3561012e-01 3.3402713e-01 3.3658348e-01 3.3430244e-01 3.3697279e-01 3.3412928e-01 3.3644842e-01 3.3332621e-01 3.3490114e-01 3.3189181e-01 3.3248559e-01 3.3011777e-01 3.2993419e-01 3.2821241e-01 3.2802507e-01 3.2683768e-01 3.2747746e-01 3.2668792e-01 3.2921624e-01 3.2807092e-01 3.3350428e-01 3.3120648e-01 3.4065819e-01 3.3549577e-01 3.4914667e-01 3.3973792e-01 3.5673451e-01 3.4171981e-01 3.5976558e-01 3.3941563e-01 3.5489483e-01 3.3175019e-01 3.4186786e-01 3.2014219e-01 3.2469006e-01 3.0802211e-01 3.1013705e-01 2.9886598e-01 3.0342334e-01 2.9471813e-01 3.0657817e-01 2.9602437e-01 3.2093734e-01 3.0326663e-01 3.4872850e-01 3.1792927e-01 3.8800187e-01 3.4108421e-01 4.2711249e-01 3.6919592e-01 4.4686841e-01 3.9113998e-01 4.3085047e-01 3.8844291e-01 3.8023096e-01 3.4328938e-01 3.1611133e-01 2.5818572e-01 2.7087457e-01 1.7309597e-01 2.6178742e-01 1.2222129e-01 2.9860355e-01 9.9708927e-02 3.8461950e-01 1.4151807e-01 5.0796319e-01 2.7196251e-01 5.9375353e-01 5.4632717e-01 5.9821311e-01 5.8173609e-01 5.1978345e-01 3.2748715e-01 4.0471728e-01 1.3105269e-01 3.1938135e-01 1.2379395e-01 2.8296049e-01 1.1271706e-01 2.9899854e-01 1.1601243e-01 3.6549249e-01 5.2162782e-02 4.6055205e-01 7.2079595e-02 5.5887699e-01 2.0734936e-02 6.2468112e-01 5.8340152e-02 6.3828928e-01 1.8188217e-02 5.8871014e-01 8.0289387e-01 4.9321137e-01 5.9535751e-02 4.1131693e-01 1.3835191e-02 3.8157432e-01 2.5701332e-02 4.0878480e-01 2.4568914e-03 4.6593192e-01 2.5125427e-02 5.3799818e-01 1.7135109e-02 5.6314067e-01 1.8987294e-02 5.7122269e-01 9.2124824e-03 5.5758057e-01 3.8558415e-03 5.2831267e-01 7.8871261e-03 5.0070787e-01 5.8648435e-03 5.0115758e-01 3.5249578e-04 5.3722309e-01 5.5985665e-05 5.8781943e-01 2.5917725e-05 6.1957736e-01 4.1710982e-05 6.2086478e-01 3.2896389e-05 5.9652557e-01 2.6543441e-05 5.6136801e-01 2.5816550e-04 5.3106965e-01 1.0365848e-03 5.1960435e-01 1.9510441e-03 5.3826927e-01 1.9227252e-03 5.8246626e-01 1.7445638e-03 6.3313726e-01 3.3059782e-03 6.6693378e-01 6.7642571e-01 6.7925267e-01 2.7711021e-02 6.6787608e-01 6.2504576e-03 6.3737547e-01 6.0459165e-03 5.8495899e-01 7.7923635e-03 5.3750910e-01 4.3893681e-02 5.1780556e-01 3.0131380e-03 5.3476626e-01 5.4727233e-04 5.8159616e-01 4.4038890e-03 6.3436206e-01 2.6890055e-03 6.7362039e-01 2.8540573e-02 6.8891735e-01 1.2085467e-01 6.7694331e-01 1.0939847e-01 6.4237436e-01 3.4245634e-02 5.9597058e-01 1.1555931e-02 5.6423380e-01 1.6508595e-01 5.6455549e-01 8.5678560e-02 5.9290620e-01 2.8526512e-02 6.3366884e-01 3.1761083e-02 6.5565162e-01 5.1922712e-02 6.6063396e-01 5.4556839e-02 6.5176420e-01 2.8211347e-02 6.3709903e-01 1.3159491e-02 6.2459966e-01 7.1497174e-03 6.2052280e-01 4.2668949e-03 6.2744988e-01 2.2347879e-03 6.4269541e-01 9.8452465e-04 6.6008329e-01 2.5230996e-04 6.7369912e-01 8.3926819e-05 6.8048644e-01 3.6143506e-05 6.8071438e-01 1.6083210e-05 6.7682836e-01 6.5412223e-06 6.7170470e-01 2.0191515e-06 6.6737280e-01 5.6642453e-07 6.6467925e-01 1.7922427e-07 6.6361428e-01 6.8574937e-08 6.6377572e-01 2.6204127e-08 6.6467214e-01 8.6241510e-09 6.6584712e-01 2.4523905e-09 6.6692796e-01 6.2534684e-10 6.6766810e-01 1.5418811e-10 6.6798020e-01 3.6294600e-11 6.6791486e-01 6.6780539e-12 6.6759938e-01 3.7458514e-13 6.6718284e-01 0.0000000e+00 6.6679307e-01 0.0000000e+00 6.6650847e-01 0.0000000e+00 6.6635750e-01 0.0000000e+00 6.6632921e-01 0.0000000e+00 6.6638656e-01 0.0000000e+00 6.6648705e-01 0.0000000e+00 6.6659416e-01 0.0000000e+00 6.6668004e-01 0.0000000e+00 6.6673244e-01 0.0000000e+00 6.6675252e-01 0.0000000e+00 6.6674607e-01 0.0000000e+00 6.6672367e-01 0.0000000e+00 6.6669722e-01 0.0000000e+00 6.6667313e-01 0.0000000e+00 6.6665579e-01 0.0000000e+00 6.6664784e-01 0.0000000e+00 6.6664668e-01 0.0000000e+00 6.6664998e-01 0.0000000e+00 6.6665664e-01 0.0000000e+00 6.6666298e-01 0.0000000e+00 6.6666750e-01 0.0000000e+00 6.6667094e-01 0.0000000e+00 6.6667169e-01 0.0000000e+00 6.6667019e-01 0.0000000e+00 6.6666881e-01 0.0000000e+00 6.6666709e-01 0.0000000e+00 6.6666570e-01 0.0000000e+00 6.6666617e-01 0.0000000e+00 6.6666617e-01 0.0000000e+00 6.6666512e-01 0.0000000e+00 6.6666542e-01 0.0000000e+00 6.6666775e-01 0.0000000e+00 6.6667343e-01 0.0000000e+00 6.6668142e-01 0.0000000e+00 6.6668095e-01 0.0000000e+00 6.6666725e-01 0.0000000e+00 6.6664695e-01 0.0000000e+00 6.6662624e-01 0.0000000e+00"

a="0.5000058 0.5000028 0.5000019 0.4999976 0.4999924 0.4999883 0.4999893 0.4999903 0.4999896 0.4999886 0.4999889 0.4999881 0.499986  0.4999851 0.4999871 0.4999879 0.4999863 0.4999844 0.4999836 0.4999814 0.4999768 0.4999732 0.4999723 0.4999701 0.4999646 0.4999595 0.4999578 0.4999553 0.4999492 0.4999441 0.4999439 0.499944  0.4999398 0.499936  0.4999389 0.4999413 0.4999378 0.4999337 0.4999369 0.4999405 0.4999358 0.4999313 0.4999386 0.4999511 0.4999561 0.499963  0.4999876 0.5000207 0.5000423 0.5000627 0.5001056 0.5001624 0.500206  0.5002459 0.5003158 0.5004104 0.5004923 0.5005673 0.5006817 0.5008363 0.500981  0.5011121 0.5012847 0.5015059 0.5017089 0.5018756 0.5020723 0.5023225 0.5025506 0.5027244 0.5029226 0.5031876 0.5034366 0.5036143 0.5038003 0.5040447 0.5042586 0.5043641 0.5044451 0.5045725 0.5046645 0.5046259 0.5045426 0.504509  0.5044572 0.5042754 0.5040397 0.5038574 0.5036794 0.5033781 0.5030078 0.5026785 0.5023619 0.5019263 0.5014131 0.5009459 0.5005291 0.5000328 0.4994824 0.4990039 0.4986253 0.4982128 0.4977573 0.497371  0.4970912 0.4967845 0.4964204 0.4961136 0.49593   0.4957482 0.4955202 0.4953544 0.4953326 0.4953475 0.4953265 0.4953528 0.4955067 0.4956942 0.4958265 0.4959652 0.4961883 0.4964224 0.4965827 0.4967276 0.4969456 0.4971926 0.4973916 0.4975803 0.4978327 0.4981138 0.4983429 0.4985319 0.4987408 0.4989518 0.4991017 0.4991971 0.4992955 0.4994015 0.4994741 0.4995183 0.4995814 0.4996729 0.4997577 0.4998272 0.4999081 0.5000013 0.5000714 0.5000996 0.5001032 0.5000929 0.5000582 0.500001  0.4999495 0.4999247 0.4999241 0.4999444 0.4999933 0.5000683 0.500146  0.5002048 0.500238  0.5002425 0.5002074 0.5001303 0.5000276 0.4999253 0.4998443 0.4998013 0.4998097 0.4998704 0.4999694 0.5000866 0.5002054 0.5003028 0.500349  0.5003202 0.5002177 0.500064  0.4998932 0.4997388 0.4996329 0.4995995 0.4996506 0.4997852 0.4999868 0.500218  0.5004223 0.5005441 0.5005493 0.5004316 0.5002071 0.4999097 0.4996004 0.4993678 0.4992892 0.4994114 0.4997348 0.5000243"
a="5.0020391e-01 5.0019251e-01 5.0013792e-01 5.0004755e-01 4.9993365e-01 4.9981922e-01 4.9973098e-01 4.9969395e-01 4.9971971e-01 4.9980952e-01 4.9995190e-01 5.0012620e-01 5.0029863e-01 5.0042996e-01 5.0047912e-01 5.0041820e-01 5.0024246e-01 4.9998433e-01 4.9970231e-01 4.9946424e-01 4.9932428e-01 4.9931867e-01 4.9946002e-01 4.9973673e-01 5.0010473e-01 5.0049422e-01 5.0081905e-01 5.0100067e-01 5.0098376e-01 5.0075240e-01 5.0032601e-01 4.9976041e-01 4.9914777e-01 4.9862550e-01 4.9835071e-01 4.9845016e-01 4.9895688e-01 4.9978355e-01 5.0074304e-01 5.0161164e-01 5.0218612e-01 5.0232977e-01 5.0198190e-01 5.0116761e-01 5.0000200e-01 4.9869561e-01 4.9751637e-01 4.9672983e-01 4.9653826e-01 4.9705751e-01 4.9830219e-01 5.0015859e-01 5.0233053e-01 5.0432765e-01 5.0555643e-01 5.0552545e-01 5.0405938e-01 5.0142083e-01 4.9821418e-01 4.9517150e-01 4.9295290e-01 4.9205355e-01 4.9276670e-01 4.9512271e-01 4.9881074e-01 5.0317308e-01 5.0732989e-01 5.1041113e-01 5.1171193e-01 5.1074536e-01 5.0724726e-01 5.0131125e-01 4.9368791e-01 4.8606976e-01 4.8073650e-01 4.7961933e-01 4.8353582e-01 4.9196158e-01 5.0335641e-01 5.1553666e-01 5.2580143e-01 5.3124175e-01 5.2950277e-01 5.2017592e-01 5.0548896e-01 4.8892736e-01 4.7318721e-01 4.5890244e-01 4.4686192e-01 4.4217120e-01 4.5434824e-01 4.8580619e-01 5.3250756e-01 5.7710254e-01 5.8197578e-01 5.3437408e-01 5.4245316e-01 6.7889320e-01 7.0320471e-01 4.3801493e-32 1.0000000e+00 2.6111736e-32 1.0000000e+00 5.1101741e-01 6.2810413e-01 5.9748342e-01 6.6332297e-01 4.4274882e-01 2.9766198e-01 2.5461073e-01 2.2963487e-01 2.1444012e-01 2.7360178e-01 3.3771039e-01 4.2761706e-01 5.0071072e-01 7.1158899e-01 7.4907518e-01 7.1646858e-01 6.5052941e-01 6.2074750e-01 5.5259445e-01 4.7290589e-01 4.0369349e-01 4.3112493e-01 4.1112961e-01 4.6308281e-01 4.5006532e-01 4.4425051e-01 4.3576318e-01 4.5324021e-01 5.2149506e-01 5.5212237e-01 5.4560801e-01 5.3360299e-01 5.4089456e-01 5.2563970e-01 5.0509812e-01 5.0320056e-01 4.9730847e-01 4.9391060e-01 4.9073993e-01 4.9626272e-01 5.0613078e-01 4.9586049e-01 4.9025539e-01 4.9435036e-01 4.9461959e-01 4.9664036e-01 4.9607495e-01 4.9337425e-01 4.8998221e-01 4.8848960e-01 4.9050980e-01 4.9679648e-01 5.0895077e-01 5.1431712e-01 5.1561105e-01 5.1549271e-01 5.1387670e-01 5.0777238e-01 4.9682463e-01 4.8931950e-01 4.8641696e-01 4.8761516e-01 4.9150279e-01 4.9579918e-01 4.9951356e-01 5.0232993e-01 5.0411897e-01 5.0498248e-01 5.0500603e-01 5.0422849e-01 5.0275578e-01 5.0085208e-01 4.9896201e-01 4.9750664e-01 4.9675906e-01 4.9675739e-01 4.9737184e-01 4.9839377e-01 4.9959474e-01 5.0073099e-01 5.0158942e-01 5.0202096e-01 5.0198880e-01 5.0153679e-01 5.0081474e-01 5.0002391e-01 4.9933726e-01 4.9886716e-01 4.9867405e-01 4.9875826e-01 4.9907795e-01 4.9954631e-01 5.0006084e-01 5.0049610e-01 5.0078107e-01"

a="3.3061776e-01 3.3108999e-01 3.3220355e-01 3.3280235e-01 3.3401622e-01 3.3448503e-01 3.3544896e-01 3.3583536e-01 3.3661875e-01 3.3668792e-01 3.3703809e-01 3.3687847e-01 3.3678867e-01 3.3641488e-01 3.3597514e-01 3.3542873e-01 3.3472920e-01 3.3411355e-01 3.3329296e-01 3.3281720e-01 3.3204966e-01 3.3188912e-01 3.3135171e-01 3.3149221e-01 3.3133010e-01 3.3163715e-01 3.3182050e-01 3.3216341e-01 3.3253018e-01 3.3282402e-01 3.3320853e-01 3.3340876e-01 3.3369363e-01 3.3378513e-01 3.3392429e-01 3.3389692e-01 3.3395342e-01 3.3381836e-01 3.3388736e-01 3.3364912e-01 3.3380825e-01 3.3347480e-01 3.3376968e-01 3.3336632e-01 3.3377616e-01 3.3334191e-01 3.3375669e-01 3.3334764e-01 3.3365008e-01 3.3335684e-01 3.3340414e-01 3.3327059e-01 3.3298656e-01 3.3303769e-01 3.3247756e-01 3.3269735e-01 3.3202299e-01 3.3231852e-01 3.3184216e-01 3.3204110e-01 3.3216403e-01 3.3201980e-01 3.3314340e-01 3.3234510e-01 3.3475853e-01 3.3298848e-01 3.3680023e-01 3.3380576e-01 3.3878808e-01 3.3450998e-01 3.4008572e-01 3.3472169e-01 3.4002628e-01 3.3407190e-01 3.3813668e-01 3.3238724e-01 3.3442121e-01 3.2980714e-01 3.2961396e-01 3.2686060e-01 3.2503146e-01 3.2435019e-01 3.2219010e-01 3.2316834e-01 3.2240458e-01 3.2413026e-01 3.2665793e-01 3.2773159e-01 3.3534445e-01 3.3386240e-01 3.4792886e-01 3.4141502e-01 3.6205454e-01 3.4806437e-01 3.7304005e-01 3.5040084e-01 3.7468476e-01 3.4509636e-01 3.6214446e-01 3.3098390e-01 3.3643795e-01 3.1090109e-01 3.0634523e-01 2.9130766e-01 2.8411857e-01 2.7890182e-01 2.7762736e-01 2.7756908e-01 2.8840680e-01 2.8813778e-01 3.1650535e-01 3.0936957e-01 3.6260643e-01 3.3893400e-01 4.1989504e-01 3.7249136e-01 4.6737435e-01 4.0154651e-01 4.8181811e-01 4.1286225e-01 4.4639998e-01 3.9270004e-01 3.6695330e-01 3.3670581e-01 2.7603165e-01 2.5999336e-01 2.1541153e-01 1.9215132e-01 2.0793708e-01 1.5550132e-01 2.4832441e-01 1.5541569e-01 3.2964083e-01 1.9985389e-01 4.5153331e-01 3.0013262e-01 5.5576183e-01 4.5357302e-01 5.8448282e-01 5.0755276e-01 5.3782327e-01 4.2328574e-01 4.2984666e-01 2.3879804e-01 3.2235539e-01 1.8219181e-01 2.4711904e-01 1.5339845e-01 2.1127173e-01 1.6265747e-01 2.2915315e-01 1.4048011e-01 2.9827881e-01 1.6198280e-01 4.6753048e-01 1.2472553e-01 5.9892598e-01 3.6397672e-01 6.5862928e-01 6.5642098e-01 6.3801592e-01 6.5414620e-01 5.3201020e-01 1.3830616e-01 4.2240952e-01 1.3706265e-02 3.5144748e-01 8.5931918e-03 3.3495395e-01 3.3404363e-03 3.7270431e-01 1.9071965e-03 4.8478604e-01 1.7734202e-03 6.0536690e-01 5.6614059e-03 6.6211687e-01 1.1902746e-02 6.4897165e-01 4.7873295e-03 5.8708765e-01 7.7037194e-01 4.8892113e-01 1.5760827e-01 4.1047839e-01 8.3719539e-03 3.7662119e-01 1.1181740e-02 3.9146427e-01 1.1501789e-02 4.5319417e-01 2.2736453e-02 5.4402234e-01 8.8446658e-03 6.2535689e-01 1.7329588e-01 6.6339026e-01 7.9034899e-01 6.5263628e-01 9.9106325e-03 6.0833154e-01 4.0157951e-03 5.4834710e-01 1.6772544e-03 4.9127151e-01 3.0427706e-03 4.5257380e-01 2.1543988e-03 4.4385553e-01 4.0927350e-04 4.6840234e-01 5.4019054e-05 5.1391235e-01 2.9267126e-04 5.6494997e-01 1.3568457e-03 6.0460344e-01 1.9001219e-03 6.2431728e-01 1.5181107e-03 6.2041471e-01 1.5064751e-03 5.9256982e-01 1.5371010e-02 5.5703777e-01 8.8909067e-01 5.3129588e-01 2.5617584e-02 5.1842652e-01 3.6533773e-02 5.2051962e-01 1.6201414e-02 5.3683895e-01 1.2196514e-02 5.6198603e-01 1.6642439e-03 5.8947110e-01 2.0772222e-03 6.1363531e-01 3.2788391e-02 6.2783845e-01 2.4363090e-02 6.2961104e-01 8.9622762e-01 6.1967834e-01 2.6746216e-02 6.0410355e-01 3.5332603e-03 5.7464449e-01 4.7150796e-03 5.4518444e-01 4.9418995e-03 5.3246335e-01 9.5564820e-04 5.3862957e-01 3.2973724e-04 5.6781113e-01 5.4543560e-05 5.9896231e-01 9.4392262e-05 6.2782624e-01 6.8778438e-04 6.4574995e-01 3.3343030e-03 6.5001818e-01 8.2799374e-03 6.4530339e-01 7.4957688e-03 6.3937064e-01 2.5138481e-03 6.3621125e-01 1.2464128e-02 6.2956251e-01 9.0353015e-01 6.1576563e-01 5.7376650e-02 5.9842780e-01 1.8105434e-03 5.8438153e-01 9.3841037e-04 5.7860874e-01 1.0460818e-03 5.8221978e-01 3.6897460e-04 5.9028751e-01 8.8810035e-04 5.9805722e-01 3.6940572e-03 6.0153219e-01 1.3019650e-02 5.9875712e-01 7.3481076e-03 5.8927712e-01 1.5288615e-03 5.7498020e-01 3.3640858e-03 5.6132054e-01 3.7741474e-02 5.5466295e-01 7.9363420e-01 5.5878280e-01 1.6979384e-02 5.7440234e-01 2.0922593e-02 5.9989350e-01 2.3550551e-02 6.3025206e-01 3.4345467e-02 6.5553977e-01 3.2828636e-02 6.6322213e-01 5.0856872e-03 6.4674460e-01 1.2860797e-03 6.1525432e-01 1.4091071e-03 5.8766426e-01 1.1850800e-03 5.8127586e-01 7.9731516e-04 6.0200790e-01 2.4306885e-04 6.3988560e-01 7.4723490e-05 6.7732277e-01 3.3576839e-05 7.0105172e-01 1.7296043e-05 7.0765247e-01 8.7414168e-06 7.0146556e-01 3.4557617e-06 6.8946779e-01 1.2224940e-06 6.7729070e-01 4.9867130e-07 6.6787206e-01 2.3775779e-07 6.6197549e-01 1.1178993e-07 6.5924894e-01 4.7463737e-08 6.5897768e-01 1.8623133e-08 6.6036389e-01 7.6620684e-09 6.6260391e-01 3.2903176e-09 6.6497605e-01 1.2761247e-09 6.6694773e-01 3.7907977e-10 6.6822145e-01 1.4268035e-12 6.6873350e-01 0.0000000e+00 6.6861457e-01 0.0000000e+00 6.6810634e-01 0.0000000e+00 6.6745951e-01 0.0000000e+00 6.6686887e-01 0.0000000e+00 6.6644723e-01 0.0000000e+00 6.6622637e-01 0.0000000e+00 6.6618233e-01 0.0000000e+00 6.6626146e-01 0.0000000e+00 6.6640040e-01 0.0000000e+00 6.6654695e-01 0.0000000e+00 6.6666749e-01 0.0000000e+00 6.6674380e-01 0.0000000e+00 6.6677488e-01 0.0000000e+00 6.6677195e-01 0.0000000e+00 6.6674741e-01 0.0000000e+00 6.6671403e-01 0.0000000e+00 6.6668190e-01 0.0000000e+00 6.6664851e-01 0.0000000e+00 6.6661140e-01 0.0000000e+00 6.6657608e-01 0.0000000e+00 6.6657501e-01 0.0000000e+00"
b=a.split(" ")
#b.remove('')
print(b)

m=[]
for el in b:
    try:
        m.append(float(el))
    except:
        pass
print(m)
density=np.array(m)

plt.figure()
plt.scatter(np.arange(len(density[1::2])),density[1::2]+density[::2])

#plt.scatter(np.arange(len(density)),density)
#plt.ylim(-0.02,0.02)

#plt.plot(np.arange(len(density)),density,marker='o')
print(len(density))
#plt.xlim(0,150)
#a=np.sum(density[::2][90:]-1/3)

#print(a)
#plt.ylim(-0.001,0.001)
#plt.xlim(200,305)

#plt.title("pf_apf after 14 steps in DMRG, dipole no good yet, number is  off\n by exactly how much extra charge we have no edgecorrect")


plt.title("Pf-Vac boundary num_sweeps=1 unconverged")

print('number after projection:',np.sum(density))
#ind=len(np.where(density>0.0001)[0])
#quit()
print(len(density)*1/2)
#density=np.copy(density_cop)
#print(density)

#print(name)
dist=np.arange(len(density))
#print(np.sum(density)/len(density))
#quit()
#print(np.sum(density))
dipoles=[]
density=density[1::2]+density[::2]
for i in range(len(density)):
    dipole=np.sum((density[:i+1]-2/3)*dist[:i+1])*8*np.pi**2/18**2
    dipoles.append(dipole)
#plt.plot(np.arange(len(density)),dipoles,marker='o')
#plt.ylim(-1,1)
#plt.ylim(0.49,0.51)

#plt.xlim(100,300)
plt.savefig('MID_TRY.png')
dist=np.arange(len(density))
ind=np.where(dist>40)
#ind=np.where(dist>6)
#print(np.sum(density[ind]))
#print(len(ind[0])/2)
print("AAAAAA")
print(np.sum(density))
print(len(density)*2/3)

dipole=np.sum((density[ind]-2/3)*(dist[ind]))*8*np.pi**2/18**2
print(dipole)
quit()
plot_densities()
quit()

name='segment_Lx_16_QH_nu_1_3_Gs_v_-0.1'
data=load_data(name)
print(data)
plt.sca

#h5_to_dict_with_attrs(data)
quit()
print(data.keys())
#print(data.keys())